import OpenSSL.crypto
import datetime
 
def get_cert_validity(cert_str):
    cert = OpenSSL.crypto.load_certificate(OpenSSL.crypto.FILETYPE_PEM, cert_str)
    not_before = datetime.datetime.strptime(cert.get_notBefore().decode('utf-8'), '%Y%m%d%H%M%SZ')
    not_after = datetime.datetime.strptime(cert.get_notAfter().decode('utf-8'), '%Y%m%d%H%M%SZ')
    return not_before, not_after
 
# 假设你有一个包含证书的字符串
cert_string = """-----BEGIN CERTIFICATE-----\r\nMIIGmzCCBYOgAwIBAgIJAKcFBLrI0EwgMA0GCSqGSIb3DQEBCwUAMIG0MQswCQYD\r\nVQQGEwJVUzEQMA4GA1UECBMHQXJpem9uYTETMBEGA1UEBxMKU2NvdHRzZGFsZTEa\r\nMBgGA1UEChMRR29EYWRkeS5jb20sIEluYy4xLTArBgNVBAsTJGh0dHA6Ly9jZXJ0\r\ncy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5LzEzMDEGA1UEAxMqR28gRGFkZHkgU2Vj\r\ndXJlIENlcnRpZmljYXRlIEF1dGhvcml0eSAtIEcyMB4XDTIzMTEwOTE0MjU1NloX\r\nDTI0MTAyNzA2MTkxNlowHTEbMBkGA1UEAwwSKi5ieWRhdXRvaW5kaWEuY29tMIIB\r\nIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzHyktEr0LbGBzb/vvM8C3vYm\r\n5zWxxpQfvas0P68bzlw0UkYcw3OnJX5+IhaKHaW7E0JGQDM4b4tcNphV1NxZpjDf\r\ntNRcUe9Gs3pkpmw8+h0QB+0oxd0P4Eb8ivoJEbWsj05y8VsyW7oDBv+mvOv1gPJG\r\nu6JUZ9idH/y5VxiEIbqedkdWtwy02OGZQb2mfD1beDg1oDyjpujTFoVm/6uy0kBm\r\nUZdXyMKfgUAOQmTcRqhK3opRuYK+HCekaB0XtZHmMLid4He4C5TEcjXVZPY6U/ta\r\nuupYRV/1QuTl+JWZS6r8cuwgJ9uhocWoZfNePMtPhfhzuU+xFeS4N4mvoY4mFwID\r\nAQABo4IDRDCCA0AwDAYDVR0TAQH/BAIwADAdBgNVHSUEFjAUBggrBgEFBQcDAQYI\r\nKwYBBQUHAwIwDgYDVR0PAQH/BAQDAgWgMDkGA1UdHwQyMDAwLqAsoCqGKGh0dHA6\r\nLy9jcmwuZ29kYWRkeS5jb20vZ2RpZzJzMS0xMTM5Ni5jcmwwXQYDVR0gBFYwVDBI\r\nBgtghkgBhv1tAQcXATA5MDcGCCsGAQUFBwIBFitodHRwOi8vY2VydGlmaWNhdGVz\r\nLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMAgGBmeBDAECATB2BggrBgEFBQcBAQRq\r\nMGgwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmdvZGFkZHkuY29tLzBABggrBgEF\r\nBQcwAoY0aHR0cDovL2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5\r\nL2dkaWcyLmNydDAfBgNVHSMEGDAWgBRAwr0njsw0gzCiM9f7bLPwtCyAzjAvBgNV\r\nHREEKDAmghIqLmJ5ZGF1dG9pbmRpYS5jb22CEGJ5ZGF1dG9pbmRpYS5jb20wHQYD\r\nVR0OBBYEFJIYuhksQ+qNvLOLv3s2TtfMid6QMIIBfAYKKwYBBAHWeQIEAgSCAWwE\r\nggFoAWYAdQDuzdBk1dsazsVct520zROiModGfLzs3sNRSFlGcR+1mwAAAYu0ebUk\r\nAAAEAwBGMEQCIGq6+1HqFsthimN/JQ1I6OfQh74hx76FqodjNTjXO6KgAiBIUnB/\r\nW1vDcuUMIzNrRg4II7pOXcYCwMSgm4I32AP5zAB2AEiw42vapkc0D+VqAvqdMOsc\r\nUgHLVt0sgdm7v6s52IRzAAABi7R5tdYAAAQDAEcwRQIhAOW9TJt+0H+DfN8kgpgS\r\n9iSfIB4IjI2wEffrKeGCJbOgAiBVmRfLNB05q+XnNzVzBN2sJXaJ8BvJqWc4QAG3\r\niN2s8wB1AFWB1MIWkDYBSuoLm1c8U/DA5Dh4cCUIFy+jqh0HE9MMAAABi7R5uHAA\r\nAAQDAEYwRAIgXNlBAi/PMCMY53EF/XmhN1lKahRcxBZVYdV9DbG/RXICIFiUtT0f\r\ndmGvsC2ar9M0PoV2V6ETmEcUJ2TDAJis6cB1MA0GCSqGSIb3DQEBCwUAA4IBAQCU\r\nDsCPhpEnMe+JEi63VDw7oKpseCiCsDBgr5gNzK8VEpc3NR+a5U2+10/5PWRmd+Wa\r\nNC0weRjORX6um0S5W099dN4kZ1zw8SWM1MYfwcIELTorrfvE8y9yoSxrxdWYqHqJ\r\ngpo5ysT4QMFj7dfMW1VHuXM2BseGAD7oTmbqQToh/mgDvCYeA7SsqLoY0CVl2Bnq\r\n+ooj3zJpVOfGrk/xU+eRxhUZvpiqy2ALVPhTlzoCr5yu89pFOfLBNsIaUBbzjXL6\r\n2E0yot4OG2cgEVRB804YGJKzgg7kBJBVCX11d4EjkKq+8b2W5y1WNABnW4zSESkx\r\nNjMg7mpLWMYunQrIW0Gq\r\n-----END CERTIFICATE-----\r\n"""
 
# 获取并打印证书的有效期
not_before, not_after = get_cert_validity(cert_string)
print(f"Valid from: {not_before} to {not_after}")